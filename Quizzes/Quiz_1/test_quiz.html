<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Quiz Page</title>
  <link rel="stylesheet" href="/styles/my_style.css">

  <!-- Firebase 8 CDNs-->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/ui/4.8.1/firebase-ui-auth.js"></script>
  <!--Firebase Authentication API Keys -->
  <script src="/scripts/firebaseAPI_DTC10.js"></script>

  <!-- Bootstrap FirebaseUI CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>

<body>

  <div class="container mt-sm-5 my-1">
    <div class="question ml-sm-5 pl-sm-5 pt-2">
      <div class="py-2 h5"><b>Question 1: </b><span id="first-goes-here"></span></div>
      <div class="ml-md-3 ml-sm-3 pl-md-5 pt-sm-0 pt-3" id="options">
        <br><br>
        <label class="options">
          <input type="radio" name="radio"> <span class="checkmark" id="first_choice"></span>
        </label>
        <div class="py-2 h5"><b></b><span id="second-goes-here"></span></div>
        <label class="options">
          <input type="radio" name="radio"> <span class="checkmark" id="second_choice"></span>
        </label>
        <div class="py-2 h5"><b></b><span id="third-goes-here"></span></div>
        <label class="options">
          <input type="radio" name="radio"> <span class="checkmark" id="third_choice"></span>
        </label>
        <div class="py-2 h5"><b></b><span id="fourth-goes-here"></span></div>
        <label class="options">
          <input type="radio" name="radio" id="CorrectChoice"> <span class="checkmark" id="fourth_choice"></span>
        </label>
        <div class="py-2 h5"><b></b><span id="fifth-goes-here"></span></div>
      </div>
    </div>
    <div class="d-flex align-items-center pt-3">

      <div id="prev"> <button class="btn btn-primary" onclick="confirmation_box()">Home</button></div>

      <div class="ml-auto mr-sm-5"> <button class="btn btn-success" id="thisisthesubmitbutton"
          onclick="myFunction()">Submit</button> </div>
      <div class="popup" onclick="myFunction()">
        <span class="popuptext" id="myPopup">You got it right!</span>
      </div>
      <a href="test_quiz.html">
        <div class="ml-auto mr-sm-5"> <button class="btn btn-secondary" id="next_button"
            style="display:none;">Next</button> </div>
      </a>
    </div>

  </div>

  <script>
    // When the user clicks home/back, confirm that they actually want to leave.
    function confirmation_box() {
      if (confirm(
          "You will have to pay another entrance fee to take the quiz again! Are you sure you want to leave?")) {
        window.location.href = "/gameplay.html"
      }
    }

    // When the user clicks on div, open the popup

    function myFunction() {
      firebase.auth().onAuthStateChanged(user => {
        // Check if user is signed in:
        if (user) {
          var popup = document.getElementById("myPopup");
          //added variable for the right radio button
          var rightanswer = document.querySelector("#CorrectChoice")

          //if the right radio button is checked when click event occurs, right answer pop-up shows
          if (rightanswer.checked == true) {
            console.log('yep')
            document.getElementById("next_button").style.display = "";
            popup.classList.toggle("show");
            currentUser.update({
              // increment the quiz_total in the firebase by 1 if user gets the right answer
              quizTotal: firebase.firestore.FieldValue.increment(1)
            })
          }
          //go to the correct user document by referencing to the user uid
          currentUser = db.collection("users").doc(user.uid);
        } else {
          // No user is signed in.
        }
      });
    }

    // function insertName() {
    //   firebase.auth().onAuthStateChanged(user => {
    //     // Check if user is signed in:
    //     if (user) {
    //       // Do something for the current logged-in user here: 
    //       console.log('H8cjwzL3KxbOtpm36JxiSEO1g7q1');
    //       //go to the correct user document by referencing to the user uid
    //       currentUser = db.collection("Quiz_Resources").doc('Quiz_Zero');
    //       //get the document for current user.
    //       currentUser.get()
    //         .then(userDoc => {
    //           var first = userDoc.data().Question_1;
    //           var second = userDoc.data().choice_1;
    //           var third = userDoc.data().choice_2;
    //           var fourth = userDoc.data().choice_3;
    //           var fifth = userDoc.data().choice_4;
    //           // var correct = userDoc.data().choice_5;

    //           $("#first-goes-here").text(first);
    //           $("#second-goes-here").text(second); //using jquery
    //           $("#third-goes-here").text(third);
    //           $("#fourth-goes-here").text(fourth);
    //           $("#fifth-goes-here").text(fifth);
    //           // $("#correct-goes-here").text(correct);
    //         })
    //     } else {
    //       // No user is signed in.
    //     }
    //   });
    // }
    // insertName();
    var myArray = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]

    function getRandomQuestion() {
      firebase.auth().onAuthStateChanged((user) => {
        if (user) {
          db.collection("Quiz_Questions")
            .where("position", ">", Math.floor(Math.random() * myArray.length))
            .limit(1)
            .onSnapshot(docs => {
              docs.forEach(doc => {
                var first = doc.data().question;
                var second = doc.data().option_one;
                var third = doc.data().option_two;
                var fourth = doc.data().option_three;
                var fifth = doc.data().option_four;
                var sixth = doc.data().answer;

                // var questionString = "<p> " + question + "</p>";
                // $("#question-goes-here").append(questionString);
                // $("#first-goes-here").append(first);
                // $("#second-goes-here").append(second);
                $("#first-goes-here").text(first);
                $("#second-goes-here").text(second);
                $("#third-goes-here").text(third);
                $("#fourth-goes-here").text(fourth);
                $("#fifth-goes-here").text(fifth);
              })
            })
        } else {
          // No user is signed in.
        }
      });
    }
    getRandomQuestion();
  </script>
  <script>
    function writeQuizQuestions() {
      var quiz = db.collection("Quiz_Questions");
      quiz.add({
        position: Math.floor(Math.random() * 24),
        question: "Is a primary source preferable over a secondary source?",
        option_one: "Not necessarily. You should make a case-by-case determination",
        option_two: "Yes. he answer is in the name. Primary: first, Secondary: second.",
        option_three: "Yes. The primary source’s first-hand knowledge of an event will always be more trustworthy than a secondary source’s knowledge.",
        option_four: "No. A secondary source doesn’t have the same bias that a primary source will.",
        answer: "Not necessarily. You should make a case-by-case determination",
      });
      quiz.add({
        position: Math.floor(Math.random() * 24),
        question: "A primary source will always be more trustworthy than a secondary source because:",
        option_one: "Well, they aren’t necessarily - you need to evaluate a source on a case-by-case basis.",
        option_two: "Well, they won’t be - everyone knows eyewitnesses are unreliable.",
        option_three: "The answer is literally in the name; primary is best, secondary is not-best.",
        option_four: "Primary sources can be trusted to have expert knowledge on a topic.",
        answer: "Well, they aren’t necessarily - you need to evaluate a source on a case-by-case basis."
      });
      quiz.add({
        position: Math.floor(Math.random() * 24),
        question: "Documentary evidence is:",
        option_one: "Generally narrated by David Attenborough.",
        option_two: "Not a relevant concept in terms of news and misinformation.",
        option_three: "Hard, objective evidence such as tax returns and legal contracts",
        option_four: "Recorded statements by primary sources.",
        answer: "Hard, objective evidence such as tax returns and legal contracts"
      });
      quiz.add({
        position: Math.floor(Math.random() * 24),
        question: "If I am reading an article and I see that the publication has made a correction to the original story, this generally means:",
        option_one: "That they may be more reputable, as reputable journalists strive to highlight and correct inaccuracies they may have included in their original story",
        option_two: "That they should be avoided at all costs, as they have failed to get the story right the first time.",
        option_three: "It doesn’t really have any bearing at all on the publication whatsoever.",
        option_four: "The Provincial (or Federal, as the case may be) regulator of Journalist Integrity has reviewed the original article and decreed that a revision be made.",
        answer: "That they may be more reputable, as reputable journalists strive to highlight and correct inaccuracies they may have included in their original story"
      });
      quiz.add({
        position: Math.floor(Math.random() * 24),
        question: "Thinktanks are just as reputable and trustworthy now as they ever were, right?",
        option_one: "What? Absolutely not. Those things have always been politically biased.",
        option_two: "Yes. Thanks to their status as charities, they remain heavily regulated and must remain free from bias lest they lose their tax exemption status.",
        option_three: "Unfortunately, no. Not to say one shouldn’t review their publications, but do so knowing that Thinktanks have become more politicized in recent years.",
        option_four: "This is a trick question. Thinktanks were abolished under the 1998 Van Dusen Political Corruption Act.",
        answer: "Unfortunately, no. Not to say one shouldn’t review their publications, but do so knowing that Thinktanks have become more politicized in recent years.",
      });
      quiz.add({
        position: Math.floor(Math.random() * 24),
        question: "Pick the least-worst option for online fact-checking tools:",
        option_one: "Facebook or Twitter.",
        option_two: "Google News and/or Bing.",
        option_three: "Politifact or Snopes.",
        option_four: "The Toronto Review’s weekly fact-checking publication.",
        answer: "Politifact or Snopes.",
      });
      quiz.add({
        position: Math.floor(Math.random() * 24),
        question: "If I see an expert quoted or making a guest appearance on a network news show I can:",
        option_one: "Rest assured that they have been properly vetted by the network and are a reputable source of information",
        option_two: "Rest assured that, regardless of anything else, they have been confirmed to be an expert in the field or subject that they are discussing",
        option_three: "Be sure that I still need to be vigilant and appropriately sceptical of the information they are providing, as there is no guarantee they have been properly vetted as a subject matter expert",
        option_four: "Rest assured that they are likely a stooge, and may not even have the credentials that they claim to possess.",
        answer: "Be sure that I still need to be vigilant and appropriately sceptical of the information they are providing, as there is no guarantee they have been properly vetted as a subject matter expert",
      });
      quiz.add({
        position: Math.floor(Math.random() * 24),
        question: "realclearpolitics.com is an example of:",
        option_one: "A source of rampant disinformation",
        option_two: "An automatically generated RSS website that uses an algorithm to avoid political bias",
        option_three: "A human-curated news aggregator that attempts to provide a broad offering of news",
        option_four: "A satire news website that is easily, and often, mistaken as a legitimate source of news.",
        answer: "A human-curated news aggregator that attempts to provide a broad offering of news",
      });
      quiz.add({
        position: Math.floor(Math.random() * 24),
        question: "if a source is okay with being directly and named in an article or story, this generally means they are speaking:",
        option_one: "On the record",
        option_two: "Off the record",
        option_three: "On background",
        option_four: "On wax",
        answer: "On the record",
      });
      quiz.add({
        position: Math.floor(Math.random() * 24),
        question: "if a source is okay with being quoted, but not identified in the article or story, this generally means they are speaking:",
        option_one: "On the record",
        option_two: "Off the record",
        option_three: "On background",
        option_four: "On wax",
        answer: "Off the record",
      });
      quiz.add({
        position: Math.floor(Math.random() * 24),
        question: "if a source is okay with providing information, but not with being cited, named, or even quoted directly, this would generally mean they are:",
        option_one: "On the record",
        option_two: "Off the record",
        option_three: "On background",
        option_four: "On wax",
        answer: "On background",
      });
      quiz.add({
        position: Math.floor(Math.random() * 24),
        question: "What is the most correct definition of misinformation?",
        option_one: "False information that is purposefully and often covertly spread with the intent of influencing public opinion",
        option_two: "The majority of the information you’ll find from the mainstream media.",
        option_three: "I think you mean 'disinformation'.",
        option_four: "Incorrect or misleading information.",
        answer: "False information that is purposefully and often covertly spread with the intent of influencing public opinion",
      });
      quiz.add({
        position: Math.floor(Math.random() * 24),
        question: "What is the most correct definition of disinformation?",
        option_one: "Incorrect and/or misleading information",
        option_two: "I think you mean 'misinformation'.",
        option_three: "False information that is purposefully and often covertly spread with the intent of influencing public opinion",
        option_four: "The academic term for songs intended to insult a rival.",
        answer: "False information that is purposefully and often covertly spread with the intent of influencing public opinion",
      });
      // quiz.add({
      //   position: Math.floor(Math.random() * 24),
      //   question: "",
      //   option_one: "",
      //   option_two: "",
      //   option_three: "",
      //   option_four: "",
      //   answer: "",
      // });
      // quiz.add({
      //   position: Math.floor(Math.random() * 24),
      //   question: "",
      //   option_one: "",
      //   option_two: "",
      //   option_three: "",
      //   option_four: "",
      //   answer: "",
      // });
    }
    writeQuizQuestions();
  </script>
</body>

</html>